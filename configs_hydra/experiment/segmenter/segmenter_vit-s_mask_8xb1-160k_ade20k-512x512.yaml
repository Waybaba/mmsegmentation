# @package _global_
defaults:
- /_base_/models/segmenter_vit-b16_mask.yaml
- /_base_/datasets/ade20k.yaml
- /_base_/default_runtime.yaml
- /_base_/schedules/schedule_160k.yaml
crop_size: &id001
  _args_:
  - - 512
    - 512
  _target_: builtins.tuple
data_preprocessor:
  size: *id001
checkpoint: https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segmenter/vit_small_p16_384_20220308-410f6037.pth
backbone_norm_cfg:
  eps: 1.0e-06
  requires_grad: true
  type: LN
model:
  backbone:
    embed_dims: 384
    img_size: *id001
    num_heads: 6
  data_preprocessor:
    size: *id001
  decode_head:
    channels: 384
    dropout_ratio: 0.0
    embed_dims: 384
    in_channels: 384
    loss_decode:
      loss_weight: 1.0
      type: CrossEntropyLoss
      use_sigmoid: false
    num_classes: 150
    num_heads: 6
    num_layers: 2
    type: SegmenterMaskTransformerHead
  pretrained: https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segmenter/vit_small_p16_384_20220308-410f6037.pth
optimizer:
  lr: 0.001
  weight_decay: 0.0
optim_wrapper:
  optimizer:
    lr: 0.001
    weight_decay: 0.0
  type: OptimWrapper
train_dataloader:
  batch_size: 1
val_dataloader:
  batch_size: 1
