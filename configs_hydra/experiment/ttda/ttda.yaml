# @package _global_

ttda_hook: 
  type: TTDAHook
  turn_on_adapt: true # for test source-only
  adapt_img_vis_freq: ???
  use_pseudo_label: ???
  pseudo_use_ori: true # use freezed source label for pseudo label
  slide_adapt: ???
  high_conf_mask:
    turn_on: true
    top_p: 0.3 # only keep top_p pixels, others set to 255

optim_wrapper:
  paramwise_cfg:
    custom_keys:
      head:
        lr_mult: 1.0
      back:
        lr_mult: 0.0 # does not train backbone
      .norm: # ! since we can not have . in name
        lr_mult: ${norm_lr_mult} # ! how to decide order?
      token_prompt:
        lr_mult: 1.0
norm_lr_mult: 1.0

custom_hooks:
  - ${ttda_hook} # ! change ttda_hook.xxx so that could be logged in wandb

default_hooks:
  visualization:
    draw: ??? # true
    interval: ??? # draw seg figure
  logger:
    interval: 10

train_cfg:
  val_interval: 100 # not used since this is TTDA

load_from: ??? # ! load from mmseg model


### TPT
model:
  backbone:
    type: MixVisionTransformerTPT
    tpt_cfg:
      num_tokens: 1
      weight_init_type: zero

# model:
#   test_cfg:
#     mode: slide

train: false
test: true
tags: [ttda_debug]
task_name: MMSEG