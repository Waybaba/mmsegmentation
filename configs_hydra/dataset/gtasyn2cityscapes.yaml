
defaults:
  - ./default.yaml
data_folder: /data
img_ratios: [0.5, 0.75, 1.0, 1.25, 1.5, 1.75]
test_dataloader:
  batch_size: 2
  dataset:
    data_prefix:
      img_path: leftImg8bit/val
      seg_map_path: gtFine/val
    data_root: /data/Cityscapes/
    pipeline:
    - type: LoadImageFromFile
    - keep_ratio: true
      scale: ${city_scale} # *id001
      type: Resize
    - type: LoadAnnotations
    - type: PackSegInputs
    type: CityscapesDataset
  num_workers: 2
  persistent_workers: true
  sampler:
    shuffle: false
    type: DefaultSampler
test_evaluator:
  iou_metrics:
  - mIoU
  type: IoUMetricWrapper

train_dataloader:
  batch_size: 2
  dataset:
    type: ConcatDataset
    datasets:
      - data_prefix:
          img_path: RGB
          seg_map_path: GT/LABELS
        data_root: /data/synthia
        pipeline:
        - type: LoadImageFromFile
        - type: LoadAnnotations
        - keep_ratio: true
          ratio_range:
            _args_:
            - [0.5, 2.0]
            _target_: builtins.tuple
          scale: ${gta_scale}
          type: RandomResize
        - cat_max_ratio: 0.75
          crop_size: ${crop_size} # *id002
          type: RandomCrop
        - prob: 0.5
          type: RandomFlip
        - type: PhotoMetricDistortion
        - type: PackSegInputs
        type: SynthiaDataset
      - data_prefix:
          img_path: images
          seg_map_path: labels
        data_root: /data/GTA5
        pipeline:
        - type: LoadImageFromFile
        - type: LoadAnnotations
        - keep_ratio: true
          ratio_range: 
            _args_:
            - [0.5, 2.0]
            _target_: builtins.tuple
          scale: ${gta_scale}
          type: RandomResize
        - cat_max_ratio: 0.75
          crop_size: ${crop_size} # *id002
          type: RandomCrop
        - prob: 0.5
          type: RandomFlip
        - type: PhotoMetricDistortion
        - type: PackSegInputs
        type: GTADataset
  num_workers: 2
  persistent_workers: true
  sampler:
    shuffle: true
    type: InfiniteSampler
tta_pipeline:
  - backend_args: null
    type: LoadImageFromFile
  - transforms:
    - - keep_ratio: true
        scale_factor: 0.5
        type: Resize
      - keep_ratio: true
        scale_factor: 0.75
        type: Resize
      - keep_ratio: true
        scale_factor: 1.0
        type: Resize
      - keep_ratio: true
        scale_factor: 1.25
        type: Resize
      - keep_ratio: true
        scale_factor: 1.5
        type: Resize
      - keep_ratio: true
        scale_factor: 1.75
        type: Resize
    - - direction: horizontal
        prob: 0.0
        type: RandomFlip
      - direction: horizontal
        prob: 1.0
        type: RandomFlip
    - - type: LoadAnnotations
    - - type: PackSegInputs
    type: TestTimeAug

val_dataloader: ${test_dataloader}
val_evaluator: ${test_evaluator}
